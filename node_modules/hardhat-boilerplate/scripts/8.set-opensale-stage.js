const colors = require('colors');

const verifier = require('./verifier');
const moralisUtils = require('./moralis/utils/moralisUtils');
const utils = require('./utils');
const stage = require('./moralis/setStage');

async function main() {
  colors.enable();

  try {
    const [deployer] = await hre.ethers.getSigners();

    console.log(`Current Network: ${hre.network.name}`.cyan);
    console.log(`Connected with the account: ${deployer.address}`.cyan);
    console.log(`Account balance: ${await deployer.getBalance()}`.cyan);
    const openSaleSettings = utils.getOpensaleSettings();

    const contractsAddressesSettings = utils.getContractsAddressesSettings();
    await verifier.askIsOk([moralisUtils.moralisSettings(), openSaleSettings, contractsAddressesSettings]);

    console.log('-------------Setting openSale stage-------------'.green);
    console.group();
    await stage.setStage(
      { ...openSaleSettings, merkleRoot: ethers.utils.formatBytes32String('') },
      contractsAddressesSettings,
    );
    console.groupEnd();
    console.log('-------------Stage was set successfully-------------'.green);
  } catch (error) {
    console.error(error);
    throw error;
  }
}

main()
  .then(() => process.exit(0))
  .catch(() => {
    process.exit(1);
  });
