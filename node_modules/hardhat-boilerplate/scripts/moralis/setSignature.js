const hre = require('hardhat');
const moralisUtils = require('./utils/moralisUtils');
const signer = require('./utils/dataSigner');

exports.setSigns = async (minterAddress, signerSettings) => {
  const options = { useMasterKey: true };

  console.log('Setting signature to giveaway whitelist:');
  console.group();

  await moralisUtils.initialize(options);

  const whitelist = await moralisUtils.getWhitelist('giveaway', options);

  const [owner] = await hre.ethers.getSigners();

  const chainId = hre.network.config.chainId;
  const domainName = signerSettings.domainName;
  const domainVersion = signerSettings.domainVersion;

  const signedWhitelist = await signer.signData(whitelist, minterAddress, chainId, domainName, domainVersion, owner);
  await moralisUtils.bulkUpdateMany('Whitelist', signedWhitelist, options);

  console.groupEnd();
  console.log('Signature for whitelist generated successfully!');
};

// main()
//   .then(() => process.exit(0))
//   .catch((error) => {
//     console.error(error);
//     process.exit(1);
//   });
