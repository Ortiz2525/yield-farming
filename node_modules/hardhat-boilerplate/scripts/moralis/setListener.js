const moralisUtils = require('./utils/moralisUtils');
const colors = require('colors');

exports.watchEventAndSync = async ({ topic, contractAddress, abi, tableName }) => {
  colors.enable();
  console.log(`-------------Setting Listener for ${topic}-------------`.green);
  console.group();
  try {
    const options = { useMasterKey: true };
    await moralisUtils.initialize(options);

    console.table(await moralisUtils.watchEvent(topic, contractAddress, abi, tableName, true));
  } catch (error) {
    console.error(error);
  }
  console.groupEnd();
  console.log(`-------------Listener for ${topic} generated successfully-------------`.green);
};
