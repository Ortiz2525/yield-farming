const hre = require('hardhat');
const colors = require('colors');

const verifier = require('./verifier');
const utils = require('./utils');
const moralisUtils = require('./moralis/utils/moralisUtils');

function LogAndBeginGroup(message) {
  Log(message);
  console.group();
}
function LogAndEndGroup(message) {
  Log(message);
  console.groupEnd();
}
function Log(message) {
  console.log(message);
}
async function main() {
  try {
    colors.enable();
    const [deployer] = await hre.ethers.getSigners();

    Log(`Current Network: ${hre.network.name}`.cyan);
    Log(`Connected with the account: ${deployer.address}`.cyan);
    Log(`Account balance: ${await deployer.getBalance()}`.cyan);

    const contractsAddressesSettings = utils.getContractsAddressesSettings();
    const { chainlinkSettings } = utils.getDeploySettings();
    const moralisSettings = moralisUtils.moralisSettings();

    await verifier.askIsOk([moralisSettings, contractsAddressesSettings, chainlinkSettings]);

    // Request random word
    LogAndBeginGroup('----- Request random word -------'.green);
    const lilVillainsMinterAddress = contractsAddressesSettings.minter;
    const LilVillainsMinter = await hre.ethers.getContractFactory('LilVillainsMinter', deployer);
    const lilVillainsMinter = await LilVillainsMinter.attach(lilVillainsMinterAddress);
    await lilVillainsMinter.requestRandomWords();
    LogAndEndGroup('Done!'.blue);
    Log('----- END -------'.green);
  } catch (error) {
    console.error(error);
    throw error;
  }
}

main()
  .then(() => process.exit(0))
  .catch(() => {
    process.exit(1);
  });
